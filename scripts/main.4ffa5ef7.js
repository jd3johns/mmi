function change_state(){var a=$(".question").attr("data-state");"prep"==a?(start_countdown(8),$(".action").html("to go to next question"),$(".question").attr("data-state","answer"),$("#state").html("Time left to answer:")):question_number<questions.length&&(question_number++,next_question())}function next_question(){start_countdown(2),$(".action").html("to answer the question"),$(".question").attr("data-state","prep"),$("#state").html("Time left to prepare:"),display_question(),$(".question").show(),$(".instructions").show(),$(".intro").hide()}function start_countdown(a){clearInterval(counter),$("#timer").html(prettify_number(a)+":00");var b=new Date;counter=setInterval(function(){var c=new Date,d="",e=Math.ceil(60*a-(c-b)/1e3),f=Math.floor(Math.abs(e)/60);e%=60,0>e?($("#timer").addClass("error"),d="-"):$("#timer").removeClass("error"),$("#timer").html(d+prettify_number(f)+":"+prettify_number(e))},1e3)}function prettify_number(a){var a=Math.abs(a);return 10>a?"0"+a:a}function display_question(){var a=questions[question_indices[question_number]];if(a){$(".text").html("("+(question_number+1)+") "+a.question);var b=source[a.source];$("#source").html('<a href="'+b.link+'">'+b.institution.full+", "+b.year+"</a>"),$("#timer").show(),$("#state").show()}else $(".text").html("Congrats! You answered all the questions. <br>Come back again!"),$("#source").html(""),$("#timer").hide(),$("#state").hide()}function shuffle(a){for(var b,c,d=a.length;d;)c=Math.floor(Math.random()*d--),b=a[d],a[d]=a[c],a[c]=b;return a}var timer,counter,question_number=-1,question_indices;$(document).ready(function(){$(".question").hide(),question_indices=Array.apply(null,Array(questions.length)).map(function(a,b){return b}),shuffle(question_indices)}),$(document).keydown(function(a){13==a.keyCode?change_state():37==a.keyCode&&question_number>-1?(question_number-=question_number>0?1:0,next_question()):39==a.keyCode&&(question_number+=question_number<questions.length?1:0,next_question())});